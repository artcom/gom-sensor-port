#!/usr/bin/env ruby

require 'rubygems'
require 'applix'

$:.unshift File.join(File.dirname(__FILE__), '..', 'lib')
require 'gom-sensor-ports'

Defaults = { :verbose => false }


Applix.main(ARGV, Defaults) do

  prolog do |*args, opts|
  end

  # example: gom-sensor-port serve /gom/sensors/udp
  handle(:serve) do |*args, options|
    puts "args: #{args.inspect}"
    puts "opts: #{options}"
    path, _ = *args
    _, node_path = (Gom::Remote::Connection.init path)
    gsp = Gom::SensorPort.new(node_path, options)
    gsp.listen
  end
end
